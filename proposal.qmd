---
title: "Impact of Urban Activity on Air Quality"
subtitle: "Project Proposal"
author: 
  - name: "W Squared - Stephen Watts, Kayla Wowk"
    affiliations:
      - name: "College of Information Science, University of Arizona"
description: "Identify the impact of urban activity on air quality in major cities in Massachusetts."
format:
  html:
    code-tools: true
    code-overflow: wrap
    code-line-numbers: true
    embed-resources: true
editor: visual
code-annotations: hover
execute:
  warning: false
jupyter: python3
---

```{python}
#| label: load-pkgs
#| message: false
#| include: false
import numpy as np
import pandas as pd
from pandas.tseries.holiday import USFederalHolidayCalendar
```

## Dataset

```{python}
#| label: load-dataset
#| message: false
#| include: false

# Load in dataframe
df24 = pd.read_csv('data/CO_2024_MA.csv')
df23 = pd.read_csv('data/CO_2023_MA.csv')
df22 = pd.read_csv('data/CO_2022_MA.csv')
df21 = pd.read_csv('data/CO_2021_MA.csv')
df19 = pd.read_csv('data/CO_2019_MA.csv')
df18 = pd.read_csv('data/CO_2018_MA.csv')
df17 = pd.read_csv('data/CO_2017_MA.csv')
df16 = pd.read_csv('data/CO_2016_MA.csv')
df_all = pd.concat([df24, df23, df22, df21, df19, df18, df17, df16], ignore_index=True)

# Rename Daily Max 8-hour CO Concentration
df_all.rename(columns={'Daily Max 8-hour CO Concentration': 'CO'}, inplace=True)

# Convert dates to datetime
df_all['Date'] = pd.to_datetime(df_all['Date'])

# Create column for seasons
def get_season(month):
    '''Returns the season for a given date'''
    if 3 <= month <= 5:
        return 'Spring'
    if 6 <= month <= 8:
        return 'Summer'
    if 9 <= month <= 11:
        return 'Fall'
    return 'Winter'
df_all['Season'] = df_all['Date'].dt.month.apply(get_season)

# Create column that signifies if it is a weekend
df_all['is_weekend'] = df_all['Date'].dt.dayofweek >= 5

# Create column that signifies if it is a federal holiday
cal = USFederalHolidayCalendar()
holidays = cal.holidays(start=df_all['Date'].min(), end=df_all['Date'].max())
df_all['is_holiday'] = df_all['Date'].isin(holidays)

# Determine which holidays create long weekends
holidays = pd.Series(holidays)

# Identify holidays that fall near or on weekends
weekend_expanding_holidays = holidays[(holidays.dt.dayofweek == 4) |
    (holidays.dt.dayofweek == 5) |
    (holidays.dt.dayofweek == 6) |
    (holidays.dt.dayofweek == 0)]

# Define long weekend days
df_all['is_long_weekend'] = (df_all['Date'].isin(weekend_expanding_holidays) |
    df_all['Date'].isin(weekend_expanding_holidays - pd.Timedelta(days=1)) |
    df_all['Date'].isin(weekend_expanding_holidays + pd.Timedelta(days=1)))

# Keep relevant columns only
df = df_all[['Date', 'Site ID', 'CO', 'Season', 'is_weekend',
          'is_holiday', 'is_long_weekend']]

#Rename Site ID
df.rename(columns={'Site ID': 'ID'}, inplace=True)

# Day of week and month for modeling
df['dayofweek'] = df['Date'].dt.dayofweek
df['month'] = df['Date'].dt.month
df['dayofyear'] = df['Date'].dt.dayofyear

# Print head() and info()
print(df.head())
print(df.info())
```

-   This is the 2016 to 2024 (excluding 2020) dataset of carbon monoxide (CO) levels in Massachusetts from the Environmental Protection Agency (EPA). The important columns include Date, Daily Max 8-hour CO Concentration, Site ID and additional added columns to account for whether the data correlates with a non-workday. The 5 largest cities in Massachusetts include Boston, Worcester, Springfield, and Cambridge. These cities belong to the following 4 counties: Suffolk County, Worcester County, Hampden County, and Middlesex County. We will be analyzing the CO levels in these specific counties as we are focusing on urban activities in major cities.
-   We find this project interesting because we both live with someone with asthma and learning more about potential triggers and how to plan around them would help with their condition.

## Questions

-   Does air quality change depend on the time of the week (weekend versus weekday) in major cities in Massachusetts?
-   If so, is there a greater change in air quality during long weekends caused by federal holidays?
-   Does air quality change depend on the season in major cities in Massachusetts?

## Analysis plan

Using both spatial and temporal data from the EPA, determine the impact of urban activity (weekend vs. weekday) on CO (or possibly other contaminants). Not only would we be able to determine variance in air quality across weekdays and weekends, but we could also determine the impact of the season, as well as the impact of longer weekends (which include a federal holiday). We have added columns to the dataset which label each row as either a weekend or not and a federal holiday or not as well as which season each row belongs to.

## Weekly Plan of Attack:

| Week | Dates | Tasks & Milestones | Assigned Member |
|:-----------------|:-----------------|:------------------|:-----------------|
| 1 | Oct 24–Oct 30 | Draft project proposal and set up GitHub repo structure | Stephen (proposal), Kayla (repo setup) |
| 2 | Oct 31–Nov 06 | Revise proposal based on peer feedback + receive instructor feedback | Stephen (revision), All members (review response) |
| 3 | Nov 07–Nov 13 | Incorporate instructor feedback into final proposal | All members |
| 4 | Nov 14–Nov 20 | Begin implementation: data cleaning, preprocessing, initial modeling | Stephen (data), Kayla (modeling) |
| 5 | Nov 21–Nov 27 | Continue modeling, refine methods, begin visualization and dashboard setup | Kayla (modeling), Stephen (viz/dashboard) |
| 6 | Nov 28–Dec 04 | Finalize modeling, validate results, begin write-up | Kayla (validation), Stephen (write-up) |
| 7 | Dec 05–Dec 11 | Conduct peer code review + finalize repo structure | All members |
| 8 | Dec 12–Dec 16 | Present project + submit final write-up | All members |

## AI usage disclaimer

ChatGPT was used to confirm the correct formatting of the above table as well as formatting of the above functions. AI was not utilized in any written portions of this assignment.
